<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Birthday Surprise!</title>

  <!-- Google Fonts: Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/TextPlugin.min.js"></script>




  <style>
    :root {
      --door-width: 300px;
      --door-height: 500px;
      --door-border: 15px;
    }

    body {
      font-family: 'Inter', sans-serif;
    }

    .sticker-img {
      height: 300px;
      width: auto;
      border-radius: 1rem;
      mix-blend-mode: multiply;
      filter: drop-shadow(2px 6px 10px rgba(0, 0, 0, 0.25));
    }

    .thought-bubble-container {
      position: relative;
      width: 180px;
      height: 140px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .thought-bubble-svg {
      width: 100%;
      height: 100%;
      position: absolute;
      z-index: 1;
    }

    .thought-bubble-text {
      position: absolute;
      z-index: 2;
      color: #d3d3d3;
      font-size: 0.85rem;
      font-weight: bold;
      text-align: center;
      padding: 0.5rem;
      max-width: 90%;
      line-height: 1.2rem;
      white-space: normal;
    }

    .wall {
      z-index: 10;
      background: #000;
    }

    .floor {
      background: linear-gradient(to bottom, #b1936a 0%, #c4a979 100%);
    }

    .wall-bottom-gradient {
      position: absolute;
      bottom: 0;
      width: 100%;
      height: 12%;
      background: linear-gradient(to top, rgba(40, 25, 10, 0.5), rgba(0, 0, 0, 0));
      pointer-events: none;
      z-index: 15;
    }

    .loader {
      border: 4px solid #f3f3f3;
      border-radius: 50%;
      border-top: 4px solid #db2777;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    /* ✅ LIGHTING FIXES START HERE */

    .lamp-wrapper {
      position: absolute;
      top: 12%;
      width: 80px;
      z-index: 60;
      /* Ensures the lamp unit stays above room background */
    }

    /* Light beam behind the lamp */
    .light-beam {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 30rem;
      height: 40rem;
      background: radial-gradient(ellipse at top, rgba(255, 245, 142, 0.85), rgba(255, 255, 200, 0.2), transparent 90%);
      filter: blur(10px);
      opacity: 1;
      z-index: 55;
      pointer-events: none;
    }

    /* Lamp image on top of the beam */
    .lamp-img {
      position: relative;
      width: 100%;
      z-index: 60;
      filter: drop-shadow(0 0 20px rgba(255, 245, 142, 0.878));
    }



    .darkness-overlay {
      position: absolute;
      inset: 0;
      background-color: rgba(20, 10, 0, 0.6);
      z-index: 50;
      pointer-events: none;
    }



    /* ✅ LIGHTING FIXES END HERE */

    /* Glass Window with blur + light */
    .glass-window {
      position: absolute;
      top: 80px;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 90px;
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 0.4rem;
      box-shadow: inset 0 0 8px rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(5px);
      /* Frosted glass effect */
      -webkit-backdrop-filter: blur(5px);
      overflow: hidden;
      z-index: 2;
    }

    /* RGB animated glow inside window */
    .rgb-glow {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg,
          red, orange, yellow, green, cyan, blue, violet, red);
      background-size: 400% 400%;
      animation: rgbGlow 3s linear infinite;
      opacity: 0.7;
      mix-blend-mode: screen;
      filter: blur(6px);
      z-index: 0;
    }

    @keyframes rgbGlow {
      0% {
        background-position: 0% 50%;
      }

      50% {
        background-position: 100% 50%;
      }

      100% {
        background-position: 0% 50%;
      }
    }

    /* Wooden cross lines (+) inside glass */
    .glass-cross {
      position: absolute;
      background-color: #5a3e2a;
      /* Wooden color to match door */
      z-index: 1;
      pointer-events: none;
      opacity: 0.8;
    }

    .glass-cross.horizontal {
      top: 50%;
      left: 0;
      width: 100%;
      height: 4px;
      transform: translateY(-50%);
    }

    .glass-cross.vertical {
      left: 50%;
      top: 0;
      width: 4px;
      height: 100%;
      transform: translateX(-50%);
    }

    #door-frame {
      perspective: 1000px;
      /* Add perspective for 3D rotation */
    }

    #birthday-door {
      transform-style: preserve-3d;
      /* Make the door rotate in 3D */
    }
  </style>

</head>

<body class="overflow-hidden font-sans bg-black">

  <!-- 🌆 Scene -->
  <div class="w-screen h-screen flex flex-col relative">

    <!-- 🧱 Wall (top 70%) -->
    <div class="flex-1 wall relative flex justify-center items-end z-20">

      <!-- Left Lamp -->
      <div class="lamp-wrapper left-1/3 -ml-[280px]">
        <div class="light-beam left-beam"></div>
        <img src="static/images/wall-light.png" alt="Lamp Left" class="lamp-img">
      </div>

      <!-- Right Lamp -->
      <div class="lamp-wrapper right-1/3 -mr-[280px]">
        <div class="light-beam right-beam"></div>
        <img src="static/images/wall-light.png" alt="Lamp Right" class="lamp-img">
      </div>




      <div id="door-frame" class="relative z-30 bg-[#5a3e2a] rounded-t shadow-[0_10px_45px_rgba(0,0,0,0.7)]"
        style="width: var(--door-width); height: var(--door-height);">
        <div id="birthday-door"
          class="absolute top-[var(--door-border)] left-[var(--door-border)] right-[var(--door-border)] bottom-0 bg-[#a0522d] cursor-pointer origin-left hover:bg-[#b5651d] transition-colors">
          <div class="absolute w-8 h-8 bg-yellow-300 rounded-full right-6 top-1/2 -translate-y-1/2"></div>
          <!-- Small Glass Window -->
          <div class="glass-window">
            <div class="glass-cross horizontal"></div>
            <div class="glass-cross vertical"></div>
            <div class="rgb-glow"></div>
          </div>

          <div class="absolute text-2xl opacity-0" id="noise1">🎉</div>
          <div class="absolute text-2xl opacity-0 top-[80px]" id="noise2">🎈</div>
          <div class="absolute text-2xl opacity-0 top-[120px]" id="noise3">🔊</div>
        </div>
      </div>

      <!-- 👧 Girl Sticker and Interactive Thought Bubble -->
      <div class="absolute z-40 bottom-0 translate-y-[15%] flex flex-col items-center" id="girlSticker"
        style="right: -300px; opacity: 1;">

        <!-- 🫧 SVG Thought Bubble -->
        <div id="thought-bubble" class="thought-bubble-container mb-2" style="opacity: 0;">
          <svg viewBox="0 0 200 140" class="thought-bubble-svg">
            <path
              d="M 30 20 Q 10 40 30 70 Q 10 100 30 120 Q 60 130 120 130 Q 160 130 180 100 Q 190 80 180 60 Q 190 30 160 20 Q 120 0 60 10 Q 40 10 30 20 Z"
              fill="none" stroke="#d3d3d3" stroke-width="3" />
          </svg>
          <div id="thought-text" class="thought-bubble-text"></div>
        </div>

        <!-- 👧 Girl Image -->
        <img src="static/images/girl-sticker.png" 
          alt="A curious girl sticker peeking." class="sticker-img"
          onerror="this.onerror=null;this.src='https://placehold.co/225x300/e2e8f0/e2e8f0?text=Image';">

        <!-- 🕳 Shadow -->
        <div class="w-28 h-5 bg-black opacity-40 rounded-full blur-lg mt-[-12px] -skew-x-[30deg]"></div>
      </div>


      <div class="wall-bottom-gradient"></div>
      <div class="absolute bottom-0 w-full h-[10%] bg-[#5a3e2a] z-10"></div>
    </div>

    <div class="h-[30%] w-full floor relative z-10 flex items-start justify-center">
      <!-- MODIFIED: Shadow intensified for new lighting -->
      <div class="absolute -top-3 w-[320px] h-6 bg-black opacity-50 rounded-full blur-xl"></div>
    </div>

    <div class="darkness-overlay"></div>
  </div>


  <!-- 🎬 JavaScript -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      gsap.registerPlugin(TextPlugin);

      // --- Element Selection ---
      const beams = document.querySelectorAll('.light-beam');
      const door = document.getElementById('birthday-door');
      const girl = document.getElementById('girlSticker');
      const doorFrame = document.getElementById('door-frame');
      const noiseElements = [document.getElementById('noise1'), document.getElementById('noise2'), document.getElementById('noise3')];
      const thoughtBubble = document.getElementById('thought-bubble');
      const thoughtText = document.getElementById('thought-text');



      // gsap.set(room, { autoAlpha: 0 });

      // Light beam flicker effect
      beams.forEach((beam, i) => {
        gsap.fromTo(beam,
          { opacity: 0.5 },
          { opacity: 0.8, repeat: -1, yoyo: true, ease: "sine.inOut", duration: 1.5, delay: i * 0.3 }
        );
      });

      // --- Noise Animation ---
      const noises = ['🎉', '🎈', '🔊', '🎶', '💖'];
      let currentNoiseIndex = 0;
      setInterval(() => {
        noiseElements.forEach(el => el.style.opacity = 0);
        const currentEl = noiseElements[currentNoiseIndex];
        currentEl.textContent = noises[Math.floor(Math.random() * noises.length)];
        gsap.to(currentEl, { opacity: 1, duration: 0.3 });
        currentNoiseIndex = (currentNoiseIndex + 1) % noiseElements.length;
      }, 2000);

      // Bubble text sequence after girl appears

      const bubbleThoughts = [
        "What's inside that door?",
        "Could it be my birthday?",
        "A surprise waiting?",
        "Should I knock?",
        "Let me see what's behind it! 🎁"
      ];

      let thoughtIndex = 0;

      function showNextThought() {
        thoughtText.innerText = bubbleThoughts[thoughtIndex];
        gsap.fromTo(thoughtText, { opacity: 0, scale: 0.8 }, { opacity: 1, scale: 1, duration: 0.6 });
        setTimeout(() => {
          gsap.to(thoughtText, {
            opacity: 0,
            duration: 0.5,
            onComplete: () => {
              thoughtIndex = (thoughtIndex + 1) % bubbleThoughts.length;
              showNextThought();
            }
          });
        }, 2500);
      }

      // Observe when girl becomes visible
      const observer = new MutationObserver(() => {
        const right = parseFloat(window.getComputedStyle(girl).right);
        if (right <= 120) {
          gsap.to(thoughtBubble, { opacity: 1, duration: 0.5 });
          showNextThought();
          observer.disconnect();
        }
      });
      observer.observe(girl, { attributes: true, attributeFilter: ['style'] });

      // setTimeout(() => {
      //   gsap.to(bubble, { opacity: 1, duration: 0.5 });
      //   showNextThought();
      // }, 4000);







      // --- Girl Animation ---
      const animateGirlIn = () => {
        const doorRect = doorFrame.getBoundingClientRect();
        const finalRightPosition = window.innerWidth - doorRect.right - 100;
        const girlTl = gsap.timeline();
        girlTl.to(girl, { duration: 8, right: finalRightPosition + 'px', autoAlpha: 1, ease: 'power2.out' });
        girlTl.to(thoughtBubble, { autoAlpha: 1, duration: 0.5, delay: 0.5 });
        girlTl.to(thoughtText, { text: "What's in there?", duration: 1.5, ease: "none" });
      };
      setTimeout(animateGirlIn, 500);





      // --- Door Opening Animation ---
      door.addEventListener('click', () => {
        const tl = gsap.timeline();
        tl.to(door, {
          rotateY: -100, // natural swing
          duration: 1.5,
          ease: "power2.inOut"
        });
        tl.to({}, {
          duration: 0.5,
          onComplete: () => {
            window.location.href = "./birthday-room.html";
          }
        });
      });



    })
  </script>
</body>

</html>